@x64

[export:yes]
(i64[] input)main(i32? res)
{
    i64[]@gpu tmp;
    tmp <- `i64[]@gpu`input;
    ?(tmp, 0)double@gpu[indexFrom::0][indexTo::?tmp](*);
    input <- `i64[]`tmp;
    res <- `i32`(input[0] + input[1] + input[2]);
}

@gpu

[indexVariableX:index]
(i64[] tmp, i64 index)double(i32? await)
{
    tmp[index] <- tmp[index] * 2;
}
